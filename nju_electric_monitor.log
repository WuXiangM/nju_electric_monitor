2025-07-27 10:09:59,453 - INFO - ====== WebDriver manager ======
2025-07-27 10:10:00,040 - INFO - Get LATEST chromedriver version for google-chrome
2025-07-27 10:10:01,138 - INFO - Get LATEST chromedriver version for google-chrome
2025-07-27 10:10:02,225 - INFO - There is no [win64] chromedriver "137.0.7151.119" for browser google-chrome "137.0.7151" in cache
2025-07-27 10:10:02,225 - INFO - Get LATEST chromedriver version for google-chrome
2025-07-27 10:10:04,592 - INFO - WebDriver version 137.0.7151.119 selected
2025-07-27 10:10:04,595 - INFO - Modern chrome version https://storage.googleapis.com/chrome-for-testing-public/137.0.7151.119/win32/chromedriver-win32.zip
2025-07-27 10:10:04,595 - INFO - About to download new driver from https://storage.googleapis.com/chrome-for-testing-public/137.0.7151.119/win32/chromedriver-win32.zip
2025-07-27 10:10:05,524 - INFO - Driver downloading response is 200
2025-07-27 10:10:06,515 - INFO - Get LATEST chromedriver version for google-chrome
2025-07-27 10:10:07,619 - INFO - Driver has been saved in cache [C:\Users\Administrator\.wdm\drivers\chromedriver\win64\137.0.7151.119]
2025-07-27 10:10:07,622 - ERROR - 浏览器驱动初始化失败: [WinError 193] %1 不是有效的 Win32 应用程序。
2025-07-27 10:16:58,439 - ERROR - 浏览器驱动初始化失败: Message: session not created: This version of ChromeDriver only supports Chrome version 138
Current browser version is 137.0.7151.122 with binary path C:\Program Files\Google\Chrome\Application\chrome.exe
Stacktrace:
	GetHandleVerifier [0x0x7ff644bee935+77845]
	GetHandleVerifier [0x0x7ff644bee990+77936]
	(No symbol) [0x0x7ff6449a9cda]
	(No symbol) [0x0x7ff6449ee53f]
	(No symbol) [0x0x7ff6449ed58b]
	(No symbol) [0x0x7ff6449e6d7d]
	(No symbol) [0x0x7ff6449e29e5]
	(No symbol) [0x0x7ff644a362ce]
	(No symbol) [0x0x7ff644a35a60]
	(No symbol) [0x0x7ff644a286a3]
	(No symbol) [0x0x7ff6449f1791]
	(No symbol) [0x0x7ff6449f2523]
	GetHandleVerifier [0x0x7ff644ec684d+3059501]
	GetHandleVerifier [0x0x7ff644ec0c0d+3035885]
	GetHandleVerifier [0x0x7ff644ee0400+3164896]
	GetHandleVerifier [0x0x7ff644c08c3e+185118]
	GetHandleVerifier [0x0x7ff644c1054f+216111]
	GetHandleVerifier [0x0x7ff644bf72e4+113092]
	GetHandleVerifier [0x0x7ff644bf7499+113529]
	GetHandleVerifier [0x0x7ff644bde298+10616]
	BaseThreadInitThunk [0x0x7ffe22e6e8d7+23]
	RtlUserThreadStart [0x0x7ffe2451c34c+44]

2025-07-27 10:17:55,980 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 10:17:55,980 - WARNING - Neither CUDA nor MPS are available - defaulting to CPU. Note: This module is much faster with a GPU.
2025-07-27 10:17:55,983 - WARNING - Downloading detection model, please wait. This may take several minutes depending upon your network connection.
2025-07-27 10:18:46,603 - INFO - Download complete
2025-07-27 10:18:46,604 - WARNING - Downloading recognition model, please wait. This may take several minutes depending upon your network connection.
2025-07-27 10:19:07,227 - INFO - Download complete.
2025-07-27 10:19:08,148 - INFO - OCR识别器初始化成功
2025-07-27 10:19:08,149 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 10:19:08,149 - INFO - 已获取登录凭据
2025-07-27 10:19:08,149 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 10:19:11,365 - INFO - 等待登录表单加载...
2025-07-27 10:19:11,370 - INFO - 登录表单已加载
2025-07-27 10:19:11,370 - INFO - 开始填写登录表单...
2025-07-27 10:19:11,404 - INFO - 用户名填写完成
2025-07-27 10:19:11,438 - INFO - 密码填写完成
2025-07-27 10:19:11,438 - INFO - 检查是否有验证码...
2025-07-27 10:19:11,438 - INFO - 查找验证码图片...
2025-07-27 10:19:11,449 - INFO - 找到验证码图片
2025-07-27 10:19:11,454 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=312
2025-07-27 10:19:12,209 - INFO - 验证码图片捕获成功
2025-07-27 10:19:12,210 - INFO - 开始识别验证码...
2025-07-27 10:19:12,262 - ERROR - 识别验证码时出错: module 'PIL.Image' has no attribute 'ANTIALIAS'
2025-07-27 10:19:12,262 - WARNING - 验证码识别失败，尝试手动输入...
2025-07-27 10:19:56,847 - INFO - 查找验证码输入框...
2025-07-27 10:19:56,882 - INFO - 验证码填写完成
2025-07-27 10:19:56,882 - INFO - 查找并点击登录按钮...
2025-07-27 10:19:56,951 - INFO - 已点击登录按钮
2025-07-27 10:20:01,952 - INFO - 等待登录成功...
2025-07-27 10:20:06,956 - INFO - 登录可能成功，继续下一步...
2025-07-27 10:20:06,957 - INFO - 查找'去充值'按钮...
2025-07-27 10:20:07,076 - INFO - 已点击充值按钮
2025-07-27 10:20:10,076 - INFO - 开始提取剩余电量信息...
2025-07-27 10:20:10,083 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 10:20:10,086 - WARNING - 未能提取到剩余电量信息
2025-07-27 10:20:10,087 - WARNING - 没有电量数据可保存
2025-07-27 10:20:10,087 - INFO - 监控流程完成
2025-07-27 10:25:27,603 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 10:25:27,604 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 10:25:27,605 - WARNING - Downloading detection model, please wait. This may take several minutes depending upon your network connection.
2025-07-27 10:26:18,482 - INFO - Download complete
2025-07-27 10:26:18,483 - WARNING - Downloading recognition model, please wait. This may take several minutes depending upon your network connection.
2025-07-27 10:26:22,426 - INFO - Download complete.
2025-07-27 10:26:23,332 - INFO - OCR识别器初始化成功
2025-07-27 10:26:23,333 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 10:26:23,333 - INFO - 已获取登录凭据
2025-07-27 10:26:23,333 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 10:26:26,550 - INFO - 等待登录表单加载...
2025-07-27 10:26:26,557 - INFO - 登录表单已加载
2025-07-27 10:26:26,557 - INFO - 开始填写登录表单...
2025-07-27 10:26:26,594 - INFO - 用户名填写完成
2025-07-27 10:26:26,631 - INFO - 密码填写完成
2025-07-27 10:26:26,631 - INFO - 检查是否有验证码...
2025-07-27 10:26:26,631 - INFO - 查找验证码图片...
2025-07-27 10:26:26,643 - INFO - 找到验证码图片
2025-07-27 10:26:26,649 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=483
2025-07-27 10:26:27,393 - INFO - 验证码图片捕获成功
2025-07-27 10:26:27,393 - INFO - 开始识别验证码...
2025-07-27 10:26:27,460 - INFO - 验证码识别结果: 4Ky
2025-07-27 10:26:27,460 - INFO - 查找验证码输入框...
2025-07-27 10:26:27,492 - INFO - 验证码填写完成
2025-07-27 10:26:27,492 - INFO - 查找并点击登录按钮...
2025-07-27 10:26:27,547 - INFO - 已点击登录按钮
2025-07-27 10:26:32,547 - INFO - 等待登录成功...
2025-07-27 10:26:37,550 - INFO - 登录可能成功，继续下一步...
2025-07-27 10:26:37,550 - INFO - 查找'去充值'按钮...
2025-07-27 10:26:37,588 - INFO - 已点击充值按钮
2025-07-27 10:26:40,589 - INFO - 开始提取剩余电量信息...
2025-07-27 10:26:40,592 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 10:26:40,597 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 10:26:40,602 - WARNING - 未找到i标签中的电量信息
2025-07-27 10:26:40,604 - INFO - 在页面源码中查找电量信息...
2025-07-27 10:26:40,610 - WARNING - 未能提取到剩余电量信息
2025-07-27 10:26:40,610 - WARNING - 没有电量数据可保存
2025-07-27 10:26:40,611 - INFO - 监控流程完成
2025-07-27 10:30:26,300 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 10:30:26,301 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 10:30:27,399 - INFO - OCR识别器初始化成功
2025-07-27 10:30:27,399 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 10:30:27,400 - INFO - 已获取登录凭据
2025-07-27 10:30:27,400 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 10:30:30,608 - INFO - 等待登录表单加载...
2025-07-27 10:30:30,614 - INFO - 登录表单已加载
2025-07-27 10:30:30,614 - INFO - 开始填写登录表单...
2025-07-27 10:30:30,669 - INFO - 用户名填写完成
2025-07-27 10:30:30,716 - INFO - 密码填写完成
2025-07-27 10:30:30,716 - INFO - 检查是否有验证码...
2025-07-27 10:30:30,716 - INFO - 查找验证码图片...
2025-07-27 10:30:30,741 - INFO - 找到验证码图片
2025-07-27 10:30:30,746 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=549
2025-07-27 10:30:31,474 - INFO - 验证码图片捕获成功
2025-07-27 10:30:31,478 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 10:30:31,479 - INFO - 验证码识别尝试 1/5
2025-07-27 10:30:31,479 - INFO - 开始识别验证码...
2025-07-27 10:30:31,479 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:30:31,479 - WARNING - 验证码识别失败，尝试 1
2025-07-27 10:30:31,479 - INFO - 验证码识别尝试 2/5
2025-07-27 10:30:31,480 - INFO - 开始识别验证码...
2025-07-27 10:30:31,480 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:30:31,480 - WARNING - 验证码识别失败，尝试 2
2025-07-27 10:30:31,480 - INFO - 验证码识别尝试 3/5
2025-07-27 10:30:31,480 - INFO - 开始识别验证码...
2025-07-27 10:30:31,481 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:30:31,481 - WARNING - 验证码识别失败，尝试 3
2025-07-27 10:30:31,481 - INFO - 验证码识别尝试 4/5
2025-07-27 10:30:31,481 - INFO - 开始识别验证码...
2025-07-27 10:30:31,481 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:30:31,481 - WARNING - 验证码识别失败，尝试 4
2025-07-27 10:30:31,481 - INFO - 验证码识别尝试 5/5
2025-07-27 10:30:31,481 - INFO - 开始识别验证码...
2025-07-27 10:30:31,482 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:30:31,482 - WARNING - 验证码识别失败，尝试 5
2025-07-27 10:30:31,482 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 10:30:48,969 - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None)': /session/10793c9ee71c95adf4ed47ae02510b15
2025-07-27 10:31:05,386 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 10:31:05,386 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 10:31:06,511 - INFO - OCR识别器初始化成功
2025-07-27 10:31:06,511 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 10:31:06,511 - INFO - 已获取登录凭据
2025-07-27 10:31:06,511 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 10:31:09,715 - INFO - 等待登录表单加载...
2025-07-27 10:31:09,720 - INFO - 登录表单已加载
2025-07-27 10:31:09,720 - INFO - 开始填写登录表单...
2025-07-27 10:31:09,754 - INFO - 用户名填写完成
2025-07-27 10:31:09,787 - INFO - 密码填写完成
2025-07-27 10:31:09,787 - INFO - 检查是否有验证码...
2025-07-27 10:31:09,788 - INFO - 查找验证码图片...
2025-07-27 10:31:09,798 - INFO - 找到验证码图片
2025-07-27 10:31:09,803 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=653
2025-07-27 10:31:10,571 - INFO - 验证码图片捕获成功
2025-07-27 10:31:10,574 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 10:31:10,574 - INFO - 验证码识别尝试 1/5
2025-07-27 10:31:10,574 - INFO - 开始识别验证码...
2025-07-27 10:31:10,575 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:31:10,575 - WARNING - 验证码识别失败，尝试 1
2025-07-27 10:31:10,575 - INFO - 验证码识别尝试 2/5
2025-07-27 10:31:10,575 - INFO - 开始识别验证码...
2025-07-27 10:31:10,575 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:31:10,575 - WARNING - 验证码识别失败，尝试 2
2025-07-27 10:31:10,575 - INFO - 验证码识别尝试 3/5
2025-07-27 10:31:10,575 - INFO - 开始识别验证码...
2025-07-27 10:31:10,576 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:31:10,576 - WARNING - 验证码识别失败，尝试 3
2025-07-27 10:31:10,576 - INFO - 验证码识别尝试 4/5
2025-07-27 10:31:10,576 - INFO - 开始识别验证码...
2025-07-27 10:31:10,577 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:31:10,577 - WARNING - 验证码识别失败，尝试 4
2025-07-27 10:31:10,577 - INFO - 验证码识别尝试 5/5
2025-07-27 10:31:10,577 - INFO - 开始识别验证码...
2025-07-27 10:31:10,577 - ERROR - 识别验证码时出错: Invalid input type. Supporting format = string(file path or url), bytes, numpy array
2025-07-27 10:31:10,577 - WARNING - 验证码识别失败，尝试 5
2025-07-27 10:31:10,577 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 10:31:35,590 - INFO - 查找验证码输入框...
2025-07-27 10:31:35,624 - INFO - 验证码填写完成
2025-07-27 10:31:35,624 - INFO - 手动验证码输入成功
2025-07-27 10:31:35,624 - INFO - 查找并点击登录按钮...
2025-07-27 10:31:35,679 - INFO - 已点击登录按钮
2025-07-27 10:31:40,680 - INFO - 等待登录成功...
2025-07-27 10:31:45,683 - INFO - 登录可能成功，继续下一步...
2025-07-27 10:31:45,683 - INFO - 查找'去充值'按钮...
2025-07-27 10:31:45,728 - INFO - 已点击充值按钮
2025-07-27 10:31:48,729 - INFO - 开始提取剩余电量信息...
2025-07-27 10:31:48,732 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 10:31:48,737 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 10:31:48,742 - WARNING - 未找到i标签中的电量信息
2025-07-27 10:31:48,744 - INFO - 在页面源码中查找电量信息...
2025-07-27 10:31:48,750 - WARNING - 未能提取到剩余电量信息
2025-07-27 10:31:48,751 - WARNING - 没有电量数据可保存
2025-07-27 10:31:48,751 - INFO - 监控流程完成
2025-07-27 11:07:58,718 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:07:58,718 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:07:59,801 - INFO - OCR识别器初始化成功
2025-07-27 11:07:59,801 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:07:59,801 - INFO - 已获取登录凭据
2025-07-27 11:07:59,801 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:08:03,013 - INFO - 等待登录表单加载...
2025-07-27 11:08:03,018 - INFO - 登录表单已加载
2025-07-27 11:08:03,018 - INFO - 开始填写登录表单...
2025-07-27 11:08:03,053 - INFO - 用户名填写完成
2025-07-27 11:08:03,100 - INFO - 密码填写完成
2025-07-27 11:08:03,100 - INFO - 检查是否有验证码...
2025-07-27 11:08:03,100 - INFO - 查找验证码图片...
2025-07-27 11:08:03,111 - INFO - 找到验证码图片
2025-07-27 11:08:03,117 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=958
2025-07-27 11:08:03,892 - INFO - 验证码图片捕获成功
2025-07-27 11:08:03,897 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:08:03,897 - INFO - 验证码识别尝试 1/5
2025-07-27 11:08:03,897 - INFO - 开始识别验证码...
2025-07-27 11:08:03,898 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:08:03,898 - WARNING - 验证码识别失败，尝试 1
2025-07-27 11:08:03,898 - INFO - 验证码识别尝试 2/5
2025-07-27 11:08:03,898 - INFO - 开始识别验证码...
2025-07-27 11:08:03,898 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:08:03,898 - WARNING - 验证码识别失败，尝试 2
2025-07-27 11:08:03,898 - INFO - 验证码识别尝试 3/5
2025-07-27 11:08:03,899 - INFO - 开始识别验证码...
2025-07-27 11:08:03,899 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:08:03,899 - WARNING - 验证码识别失败，尝试 3
2025-07-27 11:08:03,899 - INFO - 验证码识别尝试 4/5
2025-07-27 11:08:03,899 - INFO - 开始识别验证码...
2025-07-27 11:08:03,900 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:08:03,900 - WARNING - 验证码识别失败，尝试 4
2025-07-27 11:08:03,900 - INFO - 验证码识别尝试 5/5
2025-07-27 11:08:03,900 - INFO - 开始识别验证码...
2025-07-27 11:08:03,900 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:08:03,901 - WARNING - 验证码识别失败，尝试 5
2025-07-27 11:08:03,901 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 11:08:31,439 - INFO - 查找验证码输入框...
2025-07-27 11:08:31,473 - INFO - 验证码填写完成
2025-07-27 11:08:31,473 - INFO - 手动验证码输入成功
2025-07-27 11:08:31,473 - INFO - 查找并点击登录按钮...
2025-07-27 11:08:31,532 - INFO - 已点击登录按钮
2025-07-27 11:08:36,533 - INFO - 等待登录成功...
2025-07-27 11:08:41,536 - INFO - 登录可能成功，继续下一步...
2025-07-27 11:08:41,536 - INFO - 查找'去充值'按钮...
2025-07-27 11:08:41,573 - INFO - 已点击充值按钮
2025-07-27 11:08:44,575 - INFO - 开始提取剩余电量信息...
2025-07-27 11:08:44,577 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 11:08:44,582 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 11:08:44,587 - WARNING - 未找到i标签中的电量信息
2025-07-27 11:08:44,589 - INFO - 在页面源码中查找电量信息...
2025-07-27 11:08:44,595 - WARNING - 未能提取到剩余电量信息
2025-07-27 11:08:44,595 - WARNING - 没有电量数据可保存
2025-07-27 11:08:44,595 - INFO - 监控流程完成
2025-07-27 11:14:24,339 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:14:24,340 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:14:25,468 - INFO - OCR识别器初始化成功
2025-07-27 11:14:25,468 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:14:25,468 - INFO - 已获取登录凭据
2025-07-27 11:14:25,468 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:14:28,725 - INFO - 等待登录表单加载...
2025-07-27 11:14:28,733 - INFO - 登录表单已加载
2025-07-27 11:14:28,733 - INFO - 开始填写登录表单...
2025-07-27 11:14:28,775 - INFO - 用户名填写完成
2025-07-27 11:14:28,816 - INFO - 密码填写完成
2025-07-27 11:14:28,816 - INFO - 检查是否有验证码...
2025-07-27 11:14:28,816 - INFO - 查找验证码图片...
2025-07-27 11:14:28,828 - INFO - 找到验证码图片
2025-07-27 11:14:28,834 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=668
2025-07-27 11:14:29,611 - INFO - 验证码图片捕获成功
2025-07-27 11:14:29,613 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:14:29,613 - INFO - 验证码识别尝试 1/5
2025-07-27 11:14:29,613 - INFO - 开始识别验证码...
2025-07-27 11:14:29,614 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:14:29,614 - WARNING - 验证码识别失败，尝试 1
2025-07-27 11:14:29,614 - INFO - 验证码识别尝试 2/5
2025-07-27 11:14:29,614 - INFO - 开始识别验证码...
2025-07-27 11:14:29,615 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:14:29,615 - WARNING - 验证码识别失败，尝试 2
2025-07-27 11:14:29,615 - INFO - 验证码识别尝试 3/5
2025-07-27 11:14:29,615 - INFO - 开始识别验证码...
2025-07-27 11:14:29,615 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:14:29,615 - WARNING - 验证码识别失败，尝试 3
2025-07-27 11:14:29,615 - INFO - 验证码识别尝试 4/5
2025-07-27 11:14:29,615 - INFO - 开始识别验证码...
2025-07-27 11:14:29,616 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:14:29,616 - WARNING - 验证码识别失败，尝试 4
2025-07-27 11:14:29,616 - INFO - 验证码识别尝试 5/5
2025-07-27 11:14:29,616 - INFO - 开始识别验证码...
2025-07-27 11:14:29,617 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:14:29,617 - WARNING - 验证码识别失败，尝试 5
2025-07-27 11:14:29,617 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 11:14:29,626 - INFO - 验证码图片已显示，请查看
2025-07-27 11:15:11,956 - INFO - 查找验证码输入框...
2025-07-27 11:15:11,998 - INFO - 验证码填写完成
2025-07-27 11:15:11,998 - INFO - 手动验证码输入成功
2025-07-27 11:15:11,998 - INFO - 查找并点击登录按钮...
2025-07-27 11:15:12,099 - INFO - 已点击登录按钮
2025-07-27 11:15:17,100 - INFO - 等待登录成功...
2025-07-27 11:15:22,102 - INFO - 登录可能成功，继续下一步...
2025-07-27 11:15:22,103 - INFO - 查找'去充值'按钮...
2025-07-27 11:15:22,161 - INFO - 已点击充值按钮
2025-07-27 11:15:25,162 - INFO - 开始提取剩余电量信息...
2025-07-27 11:15:25,164 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 11:15:25,170 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 11:15:25,175 - WARNING - 未找到i标签中的电量信息
2025-07-27 11:15:25,176 - INFO - 在页面源码中查找电量信息...
2025-07-27 11:15:25,182 - WARNING - 未能提取到剩余电量信息
2025-07-27 11:15:25,182 - WARNING - 没有电量数据可保存
2025-07-27 11:15:25,182 - INFO - 监控流程完成
2025-07-27 11:18:48,251 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:18:48,251 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:18:49,367 - INFO - OCR识别器初始化成功
2025-07-27 11:18:49,367 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:18:49,367 - INFO - 已获取登录凭据
2025-07-27 11:18:49,367 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:18:52,587 - INFO - 等待登录表单加载...
2025-07-27 11:18:52,593 - INFO - 登录表单已加载
2025-07-27 11:18:52,594 - INFO - 开始填写登录表单...
2025-07-27 11:18:52,650 - INFO - 用户名填写完成
2025-07-27 11:18:52,693 - INFO - 密码填写完成
2025-07-27 11:18:52,693 - INFO - 检查是否有验证码...
2025-07-27 11:18:52,693 - INFO - 查找验证码图片...
2025-07-27 11:18:52,705 - INFO - 找到验证码图片
2025-07-27 11:18:52,711 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=515
2025-07-27 11:18:53,512 - INFO - 验证码图片捕获成功
2025-07-27 11:18:53,514 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:18:53,515 - INFO - 验证码识别尝试 1/5
2025-07-27 11:18:53,515 - INFO - 开始识别验证码...
2025-07-27 11:18:53,516 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:18:53,516 - WARNING - 验证码识别失败，尝试 1
2025-07-27 11:18:53,516 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:18:53,516 - INFO - 验证码识别尝试 2/5
2025-07-27 11:18:53,517 - INFO - 开始识别验证码...
2025-07-27 11:18:53,517 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:18:53,517 - WARNING - 验证码识别失败，尝试 2
2025-07-27 11:18:53,518 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:18:53,518 - INFO - 验证码识别尝试 3/5
2025-07-27 11:18:53,518 - INFO - 开始识别验证码...
2025-07-27 11:18:53,518 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:18:53,519 - WARNING - 验证码识别失败，尝试 3
2025-07-27 11:18:53,519 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:18:53,519 - INFO - 验证码识别尝试 4/5
2025-07-27 11:18:53,519 - INFO - 开始识别验证码...
2025-07-27 11:18:53,519 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:18:53,519 - WARNING - 验证码识别失败，尝试 4
2025-07-27 11:18:53,520 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:18:53,520 - INFO - 验证码识别尝试 5/5
2025-07-27 11:18:53,520 - INFO - 开始识别验证码...
2025-07-27 11:18:53,521 - ERROR - 识别验证码时出错: OpenCV(4.11.0) :-1: error: (-5:Bad argument) in function 'cvtColor'
> Overload resolution failed:
>  - src data type = bool is not supported
>  - Expected Ptr<cv::UMat> for argument 'src'

2025-07-27 11:18:53,521 - WARNING - 验证码识别失败，尝试 5
2025-07-27 11:18:53,521 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 11:18:53,529 - INFO - 验证码图片已显示，请查看
2025-07-27 11:22:51,205 - WARNING - Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ConnectionResetError(10054, '远程主机强迫关闭了一个现有的连接。', None, 10054, None)': /session/9abd3bafbb1bb31e495aa1e209e8841a
2025-07-27 11:23:15,336 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:23:15,336 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:23:16,457 - INFO - OCR识别器初始化成功
2025-07-27 11:23:16,457 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:23:16,457 - INFO - 已获取登录凭据
2025-07-27 11:23:16,457 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:23:19,709 - INFO - 等待登录表单加载...
2025-07-27 11:23:19,727 - INFO - 登录表单已加载
2025-07-27 11:23:19,727 - INFO - 开始填写登录表单...
2025-07-27 11:23:19,767 - INFO - 用户名填写完成
2025-07-27 11:23:19,811 - INFO - 密码填写完成
2025-07-27 11:23:19,811 - INFO - 检查是否有验证码...
2025-07-27 11:23:19,811 - INFO - 查找验证码图片...
2025-07-27 11:23:19,822 - INFO - 找到验证码图片
2025-07-27 11:23:19,827 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=635
2025-07-27 11:23:20,612 - INFO - 验证码图片捕获成功
2025-07-27 11:23:20,614 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:23:20,614 - INFO - 验证码识别尝试 1/5
2025-07-27 11:23:20,614 - INFO - 开始识别验证码...
2025-07-27 11:23:20,706 - INFO - 验证码识别结果: 2h6A
2025-07-27 11:23:20,706 - INFO - 查找验证码输入框...
2025-07-27 11:23:20,745 - INFO - 验证码填写完成
2025-07-27 11:23:20,745 - INFO - 验证码识别成功: 2h6A
2025-07-27 11:23:20,745 - INFO - 查找并点击登录按钮...
2025-07-27 11:23:20,820 - INFO - 已点击登录按钮
2025-07-27 11:23:25,821 - INFO - 等待登录成功...
2025-07-27 11:23:30,825 - INFO - 登录可能成功，继续下一步...
2025-07-27 11:23:30,825 - INFO - 查找'去充值'按钮...
2025-07-27 11:23:30,858 - INFO - 已点击充值按钮
2025-07-27 11:23:33,859 - INFO - 开始提取剩余电量信息...
2025-07-27 11:23:33,861 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 11:23:33,865 - WARNING - 未找到电量信息元素，尝试其他方法...
2025-07-27 11:23:33,872 - WARNING - 未找到i标签中的电量信息
2025-07-27 11:23:33,874 - INFO - 在页面源码中查找电量信息...
2025-07-27 11:23:33,879 - WARNING - 未能提取到剩余电量信息
2025-07-27 11:23:33,880 - WARNING - 没有电量数据可保存
2025-07-27 11:23:33,880 - INFO - 监控流程完成
2025-07-27 11:28:22,971 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:28:22,972 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:28:24,096 - INFO - OCR识别器初始化成功
2025-07-27 11:28:24,097 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:28:24,097 - INFO - 已获取登录凭据
2025-07-27 11:28:24,097 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:28:27,313 - INFO - 等待登录表单加载...
2025-07-27 11:28:27,318 - INFO - 登录表单已加载
2025-07-27 11:28:27,318 - INFO - 开始填写登录表单...
2025-07-27 11:28:27,361 - INFO - 用户名填写完成
2025-07-27 11:28:27,404 - INFO - 密码填写完成
2025-07-27 11:28:27,404 - INFO - 检查是否有验证码...
2025-07-27 11:28:27,404 - INFO - 查找验证码图片...
2025-07-27 11:28:27,417 - INFO - 找到验证码图片
2025-07-27 11:28:27,422 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=251
2025-07-27 11:28:28,212 - INFO - 验证码图片捕获成功
2025-07-27 11:28:28,217 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:28:28,217 - INFO - 验证码识别尝试 1/5
2025-07-27 11:28:28,217 - INFO - 开始识别验证码...
2025-07-27 11:28:28,309 - INFO - 验证码识别结果: c202
2025-07-27 11:28:28,310 - INFO - 查找验证码输入框...
2025-07-27 11:28:28,346 - INFO - 验证码填写完成
2025-07-27 11:28:28,346 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:28:28,346 - INFO - 查找并点击登录按钮...
2025-07-27 11:28:28,411 - INFO - 已点击登录按钮
2025-07-27 11:28:35,430 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:28:35,430 - INFO - 查找验证码图片...
2025-07-27 11:28:35,439 - INFO - 找到验证码图片
2025-07-27 11:28:35,443 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=437
2025-07-27 11:28:36,202 - INFO - 验证码图片捕获成功
2025-07-27 11:28:36,204 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:28:36,204 - INFO - 验证码识别尝试 2/5
2025-07-27 11:28:36,204 - INFO - 开始识别验证码...
2025-07-27 11:28:36,272 - INFO - 验证码识别结果: 1eZF
2025-07-27 11:28:36,273 - INFO - 查找验证码输入框...
2025-07-27 11:28:36,306 - INFO - 验证码填写完成
2025-07-27 11:28:36,306 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:28:36,306 - INFO - 查找并点击登录按钮...
2025-07-27 11:28:36,338 - INFO - 已点击登录按钮
2025-07-27 11:28:43,365 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:28:43,365 - INFO - 查找验证码图片...
2025-07-27 11:28:43,371 - INFO - 找到验证码图片
2025-07-27 11:28:43,374 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=437
2025-07-27 11:28:44,116 - INFO - 验证码图片捕获成功
2025-07-27 11:28:44,118 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:28:44,118 - INFO - 验证码识别尝试 3/5
2025-07-27 11:28:44,118 - INFO - 开始识别验证码...
2025-07-27 11:28:44,173 - INFO - 验证码识别结果: EZf3
2025-07-27 11:28:44,173 - INFO - 查找验证码输入框...
2025-07-27 11:28:44,237 - INFO - 验证码填写完成
2025-07-27 11:28:44,237 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:28:44,237 - INFO - 查找并点击登录按钮...
2025-07-27 11:28:44,275 - INFO - 已点击登录按钮
2025-07-27 11:28:51,286 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:28:51,286 - INFO - 查找验证码图片...
2025-07-27 11:28:51,292 - INFO - 找到验证码图片
2025-07-27 11:28:51,296 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=437
2025-07-27 11:28:52,022 - INFO - 验证码图片捕获成功
2025-07-27 11:28:52,025 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:28:52,025 - INFO - 验证码识别尝试 4/5
2025-07-27 11:28:52,025 - INFO - 开始识别验证码...
2025-07-27 11:28:52,092 - INFO - 验证码识别结果: aef2
2025-07-27 11:28:52,092 - INFO - 查找验证码输入框...
2025-07-27 11:28:52,123 - INFO - 验证码填写完成
2025-07-27 11:28:52,123 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:28:52,123 - INFO - 查找并点击登录按钮...
2025-07-27 11:28:52,154 - INFO - 已点击登录按钮
2025-07-27 11:28:59,167 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:28:59,167 - INFO - 查找验证码图片...
2025-07-27 11:28:59,175 - INFO - 找到验证码图片
2025-07-27 11:28:59,179 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=437
2025-07-27 11:28:59,925 - INFO - 验证码图片捕获成功
2025-07-27 11:28:59,927 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:28:59,927 - INFO - 验证码识别尝试 5/5
2025-07-27 11:28:59,927 - INFO - 开始识别验证码...
2025-07-27 11:28:59,987 - INFO - 验证码识别结果: E1f
2025-07-27 11:28:59,987 - INFO - 查找验证码输入框...
2025-07-27 11:29:00,026 - INFO - 验证码填写完成
2025-07-27 11:29:00,027 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:29:00,027 - INFO - 查找并点击登录按钮...
2025-07-27 11:29:00,063 - INFO - 已点击登录按钮
2025-07-27 11:29:07,074 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:29:07,074 - INFO - 查找验证码图片...
2025-07-27 11:29:07,102 - INFO - 找到验证码图片
2025-07-27 11:29:07,106 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=437
2025-07-27 11:29:07,854 - INFO - 验证码图片捕获成功
2025-07-27 11:29:07,855 - WARNING - 自动验证码识别失败，请手动输入
2025-07-27 11:29:07,863 - INFO - 验证码图片已显示，请查看
2025-07-27 11:32:40,099 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:32:40,100 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:32:41,202 - INFO - OCR识别器初始化成功
2025-07-27 11:32:41,202 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:32:41,202 - INFO - 已获取登录凭据
2025-07-27 11:32:41,202 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:32:44,405 - INFO - 等待登录表单加载...
2025-07-27 11:32:44,412 - INFO - 登录表单已加载
2025-07-27 11:32:44,413 - INFO - 开始填写登录表单...
2025-07-27 11:32:44,466 - INFO - 用户名填写完成
2025-07-27 11:32:44,505 - INFO - 密码填写完成
2025-07-27 11:32:44,505 - INFO - 检查是否有验证码...
2025-07-27 11:32:44,505 - INFO - 查找验证码图片...
2025-07-27 11:32:44,531 - INFO - 找到验证码图片
2025-07-27 11:32:44,536 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=344
2025-07-27 11:32:45,357 - INFO - 验证码图片捕获成功
2025-07-27 11:32:45,358 - INFO - 开始填写登录表单...
2025-07-27 11:32:45,405 - INFO - 用户名填写完成
2025-07-27 11:32:45,447 - INFO - 密码填写完成
2025-07-27 11:32:45,448 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:32:45,448 - INFO - 验证码识别尝试 1/5
2025-07-27 11:32:45,448 - INFO - 开始识别验证码...
2025-07-27 11:32:45,547 - WARNING - 验证码识别结果为空
2025-07-27 11:32:45,547 - INFO - 尝试不同的图像处理参数...
2025-07-27 11:32:45,751 - INFO - 方法4识别结果: Qd87
2025-07-27 11:32:45,752 - INFO - 查找验证码输入框...
2025-07-27 11:32:45,787 - INFO - 验证码填写完成
2025-07-27 11:32:45,787 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:32:45,787 - INFO - 查找并点击登录按钮...
2025-07-27 11:32:45,842 - INFO - 已点击登录按钮
2025-07-27 11:32:52,858 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:32:52,858 - INFO - 查找验证码图片...
2025-07-27 11:32:52,879 - INFO - 找到验证码图片
2025-07-27 11:32:52,883 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=874
2025-07-27 11:32:53,670 - INFO - 验证码图片捕获成功
2025-07-27 11:32:53,671 - INFO - 开始填写登录表单...
2025-07-27 11:32:53,726 - INFO - 用户名填写完成
2025-07-27 11:32:53,788 - INFO - 密码填写完成
2025-07-27 11:32:53,789 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:32:53,789 - INFO - 验证码识别尝试 2/5
2025-07-27 11:32:53,789 - INFO - 开始识别验证码...
2025-07-27 11:32:53,859 - WARNING - 验证码识别结果为空
2025-07-27 11:32:53,859 - INFO - 尝试不同的图像处理参数...
2025-07-27 11:32:54,046 - INFO - 方法4识别结果: 3X8
2025-07-27 11:32:54,046 - INFO - 查找验证码输入框...
2025-07-27 11:32:54,082 - INFO - 验证码填写完成
2025-07-27 11:32:54,082 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:32:54,083 - INFO - 查找并点击登录按钮...
2025-07-27 11:32:54,137 - INFO - 已点击登录按钮
2025-07-27 11:33:01,148 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:33:01,148 - INFO - 查找验证码图片...
2025-07-27 11:33:01,154 - INFO - 找到验证码图片
2025-07-27 11:33:01,158 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=159
2025-07-27 11:33:01,923 - INFO - 验证码图片捕获成功
2025-07-27 11:33:01,924 - INFO - 开始填写登录表单...
2025-07-27 11:33:01,990 - INFO - 用户名填写完成
2025-07-27 11:33:02,033 - INFO - 密码填写完成
2025-07-27 11:33:02,034 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:33:02,034 - INFO - 验证码识别尝试 3/5
2025-07-27 11:33:02,034 - INFO - 开始识别验证码...
2025-07-27 11:33:02,101 - INFO - 验证码识别结果: CXFC
2025-07-27 11:33:02,102 - INFO - 查找验证码输入框...
2025-07-27 11:33:02,142 - INFO - 验证码填写完成
2025-07-27 11:33:02,142 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:33:02,142 - INFO - 查找并点击登录按钮...
2025-07-27 11:33:02,197 - INFO - 已点击登录按钮
2025-07-27 11:33:09,209 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:33:09,209 - INFO - 查找验证码图片...
2025-07-27 11:33:09,216 - INFO - 找到验证码图片
2025-07-27 11:33:09,220 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=210
2025-07-27 11:33:09,972 - INFO - 验证码图片捕获成功
2025-07-27 11:33:09,973 - INFO - 开始填写登录表单...
2025-07-27 11:33:10,019 - INFO - 用户名填写完成
2025-07-27 11:33:10,065 - INFO - 密码填写完成
2025-07-27 11:33:10,066 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:33:10,066 - INFO - 验证码识别尝试 4/5
2025-07-27 11:33:10,066 - INFO - 开始识别验证码...
2025-07-27 11:33:10,138 - INFO - 验证码识别结果: XNkK
2025-07-27 11:33:10,138 - INFO - 查找验证码输入框...
2025-07-27 11:33:10,175 - INFO - 验证码填写完成
2025-07-27 11:33:10,176 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:33:10,176 - INFO - 查找并点击登录按钮...
2025-07-27 11:33:10,231 - INFO - 已点击登录按钮
2025-07-27 11:33:17,243 - WARNING - 检测到无效的验证码提示，准备重试...
2025-07-27 11:33:17,243 - INFO - 查找验证码图片...
2025-07-27 11:33:17,249 - INFO - 找到验证码图片
2025-07-27 11:33:17,253 - INFO - 验证码图片URL: https://authserver.nju.edu.cn/authserver/captcha.html?ts=275
2025-07-27 11:33:18,052 - INFO - 验证码图片捕获成功
2025-07-27 11:33:18,053 - INFO - 开始填写登录表单...
2025-07-27 11:33:18,101 - INFO - 用户名填写完成
2025-07-27 11:33:18,145 - INFO - 密码填写完成
2025-07-27 11:33:18,146 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:33:18,146 - INFO - 验证码识别尝试 5/5
2025-07-27 11:33:18,146 - INFO - 开始识别验证码...
2025-07-27 11:33:18,222 - INFO - 验证码识别结果: ZXXN
2025-07-27 11:33:18,222 - INFO - 查找验证码输入框...
2025-07-27 11:33:18,261 - INFO - 验证码填写完成
2025-07-27 11:33:18,262 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:33:18,262 - INFO - 查找并点击登录按钮...
2025-07-27 11:33:18,322 - INFO - 已点击登录按钮
2025-07-27 11:33:25,324 - WARNING - 检测验证码错误元素时出错: Message: invalid session id: session deleted as the browser has closed the connection
from disconnected: not connected to DevTools
  (Session info: chrome=138.0.7204.169)
Stacktrace:
	GetHandleVerifier [0x0x7ff644bee935+77845]
	GetHandleVerifier [0x0x7ff644bee990+77936]
	(No symbol) [0x0x7ff6449a9cda]
	(No symbol) [0x0x7ff644995f35]
	(No symbol) [0x0x7ff6449baabe]
	(No symbol) [0x0x7ff644a2feb5]
	(No symbol) [0x0x7ff644a50432]
	(No symbol) [0x0x7ff644a286a3]
	(No symbol) [0x0x7ff6449f1791]
	(No symbol) [0x0x7ff6449f2523]
	GetHandleVerifier [0x0x7ff644ec684d+3059501]
	GetHandleVerifier [0x0x7ff644ec0c0d+3035885]
	GetHandleVerifier [0x0x7ff644ee0400+3164896]
	GetHandleVerifier [0x0x7ff644c08c3e+185118]
	GetHandleVerifier [0x0x7ff644c1054f+216111]
	GetHandleVerifier [0x0x7ff644bf72e4+113092]
	GetHandleVerifier [0x0x7ff644bf7499+113529]
	GetHandleVerifier [0x0x7ff644bde298+10616]
	BaseThreadInitThunk [0x0x7ffe22e6e8d7+23]
	RtlUserThreadStart [0x0x7ffe2451c34c+44]

2025-07-27 11:33:25,324 - INFO - 查找并点击登录按钮...
2025-07-27 11:33:25,370 - ERROR - 点击登录按钮时出错: Message: invalid session id
Stacktrace:
	GetHandleVerifier [0x0x7ff644bee935+77845]
	GetHandleVerifier [0x0x7ff644bee990+77936]
	(No symbol) [0x0x7ff6449a9b0c]
	(No symbol) [0x0x7ff6449f08bf]
	(No symbol) [0x0x7ff644a28792]
	(No symbol) [0x0x7ff644a23293]
	(No symbol) [0x0x7ff644a22359]
	(No symbol) [0x0x7ff644974b05]
	GetHandleVerifier [0x0x7ff644ec684d+3059501]
	GetHandleVerifier [0x0x7ff644ec0c0d+3035885]
	GetHandleVerifier [0x0x7ff644ee0400+3164896]
	GetHandleVerifier [0x0x7ff644c08c3e+185118]
	GetHandleVerifier [0x0x7ff644c1054f+216111]
	(No symbol) [0x0x7ff644973b00]
	GetHandleVerifier [0x0x7ff644febd98+4260984]
	BaseThreadInitThunk [0x0x7ffe22e6e8d7+23]
	RtlUserThreadStart [0x0x7ffe2451c34c+44]

2025-07-27 11:33:25,371 - ERROR - 点击登录按钮失败
2025-07-27 11:34:36,517 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:34:36,518 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:34:37,640 - INFO - OCR识别器初始化成功
2025-07-27 11:34:37,640 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:34:37,640 - INFO - 已获取登录凭据
2025-07-27 11:34:37,640 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:34:40,887 - INFO - 等待登录表单加载...
2025-07-27 11:34:40,893 - INFO - 登录表单已加载
2025-07-27 11:34:40,893 - INFO - 开始填写登录表单...
2025-07-27 11:34:40,944 - INFO - 用户名填写完成
2025-07-27 11:34:40,987 - INFO - 密码填写完成
2025-07-27 11:34:40,988 - INFO - 检查是否有验证码...
2025-07-27 11:34:40,988 - INFO - 查找验证码图片...
2025-07-27 11:34:41,000 - INFO - 找到验证码图片，开始截图...
2025-07-27 11:34:41,034 - INFO - 验证码图片截取成功
2025-07-27 11:34:41,034 - INFO - 开始填写登录表单...
2025-07-27 11:34:41,083 - INFO - 用户名填写完成
2025-07-27 11:34:41,126 - INFO - 密码填写完成
2025-07-27 11:34:41,128 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:34:41,128 - INFO - 验证码识别尝试 1/5
2025-07-27 11:34:41,128 - INFO - 开始识别验证码...
2025-07-27 11:34:41,253 - INFO - 验证码识别结果: k426
2025-07-27 11:34:41,253 - INFO - 查找验证码输入框...
2025-07-27 11:34:41,289 - INFO - 验证码填写完成
2025-07-27 11:34:41,289 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:34:41,289 - INFO - 查找并点击登录按钮...
2025-07-27 11:34:42,850 - INFO - 已点击登录按钮
2025-07-27 11:34:49,856 - INFO - 未检测到无效验证码提示，验证码通过
2025-07-27 11:34:49,856 - INFO - 查找并点击登录按钮...
2025-07-27 11:34:49,859 - ERROR - 未找到登录按钮
2025-07-27 11:34:49,859 - ERROR - 点击登录按钮失败
2025-07-27 11:37:27,222 - INFO - 使用本地ChromeDriver: chromedriver-win64/chromedriver.exe
2025-07-27 11:37:27,222 - WARNING - Using CPU. Note: This module is much faster with a GPU.
2025-07-27 11:37:28,313 - INFO - OCR识别器初始化成功
2025-07-27 11:37:28,313 - INFO - 开始南京大学电费监控流程（自动无头模式）
2025-07-27 11:37:28,313 - INFO - 已获取登录凭据
2025-07-27 11:37:28,313 - INFO - 正在打开页面: https://epay.nju.edu.cn/epay/h5/nju/electric/index
2025-07-27 11:37:31,523 - INFO - 等待登录表单加载...
2025-07-27 11:37:31,528 - INFO - 登录表单已加载
2025-07-27 11:37:31,528 - INFO - 开始填写登录表单...
2025-07-27 11:37:31,580 - INFO - 用户名填写完成
2025-07-27 11:37:31,627 - INFO - 密码填写完成
2025-07-27 11:37:31,627 - INFO - 检查是否有验证码...
2025-07-27 11:37:31,627 - INFO - 查找验证码图片...
2025-07-27 11:37:31,640 - INFO - 找到验证码图片，开始截图...
2025-07-27 11:37:31,676 - INFO - 验证码图片截取成功
2025-07-27 11:37:31,676 - INFO - 开始填写登录表单...
2025-07-27 11:37:31,722 - INFO - 用户名填写完成
2025-07-27 11:37:31,775 - INFO - 密码填写完成
2025-07-27 11:37:31,776 - INFO - 验证码图片已保存到 captcha_debug.png
2025-07-27 11:37:31,776 - INFO - 验证码识别尝试 1/5
2025-07-27 11:37:31,776 - INFO - 开始识别验证码...
2025-07-27 11:37:31,883 - INFO - 验证码识别结果: aBfh
2025-07-27 11:37:31,883 - INFO - 查找验证码输入框...
2025-07-27 11:37:31,922 - INFO - 验证码填写完成
2025-07-27 11:37:31,923 - INFO - 验证码填写完成，点击登录按钮...
2025-07-27 11:37:31,923 - INFO - 查找并点击登录按钮...
2025-07-27 11:37:33,575 - INFO - 已点击登录按钮
2025-07-27 11:37:40,582 - INFO - 未检测到无效验证码提示，验证码通过
2025-07-27 11:37:40,582 - INFO - 查找并点击登录按钮...
2025-07-27 11:37:40,585 - ERROR - 未找到登录按钮
2025-07-27 11:37:40,585 - ERROR - 点击登录按钮失败
2025-07-27 11:37:40,585 - INFO - 等待登录成功...
2025-07-27 11:37:45,587 - INFO - 登录可能成功，继续下一步...
2025-07-27 11:37:45,588 - INFO - 查找'去充值'按钮...
2025-07-27 11:37:46,156 - INFO - 已点击充值按钮
2025-07-27 11:37:49,157 - INFO - 开始提取剩余电量信息...
2025-07-27 11:37:49,159 - INFO - 页面源码已保存到 debug_page_source.html
2025-07-27 11:37:49,170 - INFO - 找到电量信息元素: 持卡人姓名：吴相民
2025-07-27 11:37:49,170 - WARNING - 未在元素中找到标准格式的电量信息
2025-07-27 11:37:49,179 - INFO - 找到i标签中的电量信息: 吴相民
2025-07-27 11:37:49,180 - WARNING - i标签中未找到标准格式的电量信息
2025-07-27 11:37:49,181 - INFO - 在页面源码中查找电量信息...
2025-07-27 11:37:49,181 - INFO - 从页面源码中提取到剩余电量: 21.75 度
2025-07-27 11:37:49,183 - INFO - 数据已保存: 21.75 度
2025-07-27 11:37:49,183 - INFO - 监控流程完成
